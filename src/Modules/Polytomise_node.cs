using System;
using System.Collections.Generic;
using PhyloTree;
using TreeViewer;
using System.Text.RegularExpressions;
using VectSharp;
using System.Runtime.InteropServices;

namespace a19d9a55507e64dacafc1d5ffcef35f76
{
    /// <summary>
    /// This module is used to transform a node into a polytomy. It is possible to select either a single node, or to specify
    /// a criterion according to which nodes will be transformed into polytomies; this is useful e.g. to collapse nodes with
    /// low support values.
    ///    </summary>
    /// <description>
    /// <![CDATA[
    /// ## Further information
    /// The module picks the children of the selected node and drafts them on the parent node. For example, consider the tree
    /// `((a,(b,(c,d))),e);`:
    /// 
    /// <p align="center">
    /// <img height="300" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHZpZXdCb3g9IjAgMCAxMDguNjkgODUuODEiIHZlcnNpb249IjEuMSIgc3R5bGU9ImZvbnQtc3ludGhlc2lzOiBub25lOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCiAgPHBhdGggZD0iTSAwIDAgTCAxMDguNjkgMCBMIDEwOC42OSA4NS44MSBMIDAgODUuODEgWiAiIHN0cm9rZT0ibm9uZSIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1vcGFjaXR5PSIxIiB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwxLDAsMCkiIC8+DQogIDxwYXRoIGQ9Ik0gLTcgNDEuMTI1IEwgMCA0MS4xMjUgIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIxIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZmlsbD0ibm9uZSIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxOSwxMCkiIGlkPSIwZWMxNzYxOS0xZWE1LTRiNzQtYmVmYi00MDYxZDMzNDdmYWYiIC8+DQogIDxwYXRoIGQ9Ik0gMCA0MS4xMjUgTCAwIDE5LjI0OTk5OTk5OTk5OTk5NiBMIDE3LjUgMTkuMjQ5OTk5OTk5OTk5OTk2ICIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTksMTApIiBpZD0iODZkY2RkODctODdhMi00YjBjLWI3YmItODhlZTAyZGIyMDk4IiAvPg0KICA8cGF0aCBkPSJNIDE3LjUgMTkuMjQ5OTk5OTk5OTk5OTk2IEwgMTcuNSA3IEwgMzUgNyAiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjEiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBmaWxsPSJub25lIiB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwxLDE5LDEwKSIgaWQ9IjYzYmE5YTA3LTA1YzMtNDZjYi1hNWExLTFjOTQxY2I1YTg1YyIgLz4NCiAgPHBhdGggZD0iTSAxNy41IDE5LjI0OTk5OTk5OTk5OTk5NiBMIDE3LjUgMzEuNDk5OTk5OTk5OTk5OTk2IEwgMzUgMzEuNDk5OTk5OTk5OTk5OTk2ICIgc3Ryb2tlPSIjRDU1RTAwIiBzdHJva2Utb3BhY2l0eT0iMSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTksMTApIiBpZD0iMDUyZDBjNjAtNDRjMy00MjA2LTllOTgtMzNlMDYyMDk2MjJkIiAvPg0KICA8cGF0aCBkPSJNIDM1IDMxLjQ5OTk5OTk5OTk5OTk5NiBMIDM1IDIxIEwgNTIuNSAyMSAiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjEiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBmaWxsPSJub25lIiB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwxLDE5LDEwKSIgaWQ9IjcyZTBmYjNlLWQ2ZGUtNDEwNC04MzFjLThhMWUxODg0YzAzNyIgLz4NCiAgPHBhdGggZD0iTSAzNSAzMS40OTk5OTk5OTk5OTk5OTYgTCAzNSA0MiBMIDUyLjUgNDIgIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIxIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZmlsbD0ibm9uZSIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxOSwxMCkiIGlkPSI2YjIyNGQ5Yi0zODc4LTQwMDYtOTdiMy0wMWE0OGM1NWQ5OTQiIC8+DQogIDxwYXRoIGQ9Ik0gNTIuNSA0MiBMIDUyLjUgMzUgTCA3MCAzNSAiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjEiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBmaWxsPSJub25lIiB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwxLDE5LDEwKSIgaWQ9IjBlNzk5MTJiLWQ0NjAtNDRmOS1hZjVmLWRmZTA0NzE2NzI4OSIgLz4NCiAgPHBhdGggZD0iTSA1Mi41IDQyIEwgNTIuNSA0OSBMIDcwIDQ5ICIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTksMTApIiBpZD0iOTM1NGY2ZGUtZjU3NC00OWRjLTg5NjYtZDUwMzkxODVlYjkwIiAvPg0KICA8cGF0aCBkPSJNIDAgNDEuMTI1IEwgMCA2MyBMIDE3LjUgNjMgIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIxIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZmlsbD0ibm9uZSIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxOSwxMCkiIGlkPSI1NzVlNjUxYS02NTQwLTQzMTQtYjY1Ny1jZTY3MzNiYjJjM2QiIC8+DQogIDxwYXRoIGQ9Ik0gOS45MyAyLjA5IEwgOS45MyAyLjcyIEMgOS42OSAyLjc4MDAwMDAwMDAwMDAwMDIsIDkuNSAyLjgxLCA5LjM2IDIuODEgQyA5LjA4NjY2NjY2NjY2NjY2NiAyLjgxLCA4Ljg4MTY2NjY2NjY2NjY2NiAyLjc0ODMzMzMzMzMzMzMzMywgOC43NDUwMDAwMDAwMDAwMDEgMi42MjUgQyA4LjYwODMzMzMzMzMzMzMzMyAyLjUwMTY2NjY2NjY2NjY2NywgOC41MjY2NjY2NjY2NjY2NjYgMi4zMDY2NjY2NjY2NjY2NjY2LCA4LjUgMi4wNCBDIDcuOTM5OTk5OTk5OTk5OTk5NSAyLjU1MzMzMzMzMzMzMzMzMzIsIDcuMzQ2NjY2NjY2NjY2NjY3IDIuODEsIDYuNzIwMDAwMDAwMDAwMDAxIDIuODEgQyA2LjE5MzMzMzMzMzMzMzMzMyAyLjgxLCA1Ljc3NDk5OTk5OTk5OTk5OTUgMi42NywgNS40NjUgMi4zOSBDIDUuMTU1IDIuMTEwMDAwMDAwMDAwMDAwMywgNSAxLjczMzMzMzMzMzMzMzMzMzQsIDUgMS4yNiBDIDUgMC41ODY2NjY2NjY2NjY2NjY3LCA1LjMwNjY2NjY2NjY2NjY2NyAwLjExOTk5OTk5OTk5OTk5OTk0LCA1LjkyIC0wLjE0MDAwMDAwMDAwMDAwMDEyIEMgNi4wODY2NjY2NjY2NjY2NjcgLTAuMjA2NjY2NjY2NjY2NjY2NTUsIDYuMjYzMzMzMzMzMzMzMzM0IC0wLjI1ODMzMzMzMzMzMzMzMzE0LCA2LjQ1IC0wLjI5NDk5OTk5OTk5OTk5OTkzIEMgNi42MzY2NjY2NjY2NjY2NjcgLTAuMzMxNjY2NjY2NjY2NjY2NywgNy4wMjAwMDAwMDAwMDAwMDA1IC0wLjM4NjY2NjY2NjY2NjY2NjcsIDcuNiAtMC40NTk5OTk5OTk5OTk5OTk5NiBDIDcuOTM5OTk5OTk5OTk5OTk5NSAtMC41MDY2NjY2NjY2NjY2NjY2LCA4LjE2ODMzMzMzMzMzMzMzMyAtMC41Njk5OTk5OTk5OTk5OTk4LCA4LjI4NSAtMC42NDk5OTk5OTk5OTk5OTk5IEMgOC40MDE2NjY2NjY2NjY2NjcgLTAuNzMsIDguNDYzMzMzMzMzMzMzMzM1IC0wLjg2LCA4LjQ3IC0xLjA0IEwgOC40NyAtMS4yNTk5OTk5OTk5OTk5OTk4IEMgOC40NyAtMS43OCwgOC4wODAwMDAwMDAwMDAwMDIgLTIuMDQsIDcuMzAwMDAwMDAwMDAwMDAxIC0yLjA0IEMgNi45MTMzMzMzMzMzMzMzMzQgLTIuMDQsIDYuNjIwMDAwMDAwMDAwMDAxIC0xLjk2NDk5OTk5OTk5OTk5OTksIDYuNDIgLTEuODE0OTk5OTk5OTk5OTk5NSBDIDYuMjIwMDAwMDAwMDAwMDAxIC0xLjY2NDk5OTk5OTk5OTk5OTYsIDYuMTAzMzMzMzMzMzMzMzMzNSAtMS40Mjk5OTk5OTk5OTk5OTk3LCA2LjA3IC0xLjEwOTk5OTk5OTk5OTk5OTkgTCA1LjIzIC0xLjEwOTk5OTk5OTk5OTk5OTkgQyA1LjI1IC0xLjU4OTk5OTk5OTk5OTk5OTksIDUuMzY5OTk5OTk5OTk5OTk5IC0xLjk1MzMzMzMzMzMzMzMzMzQsIDUuNTkgLTIuMiBDIDUuOTYzMzMzMzMzMzMzMzM0IC0yLjYwNjY2NjY2NjY2NjY2NjUsIDYuNTQzMzMzMzMzMzMzMzM0IC0yLjgwOTk5OTk5OTk5OTk5OTYsIDcuMzMgLTIuODA5OTk5OTk5OTk5OTk5NiBDIDcuOTc2NjY2NjY2NjY2NjY3NSAtMi44MDk5OTk5OTk5OTk5OTk2LCA4LjQ2NjY2NjY2NjY2NjY2OSAtMi42ODgzMzMzMzMzMzMzMzMsIDguOCAtMi40NDUwMDAwMDAwMDAwMDAzIEMgOS4xMzMzMzMzMzMzMzMzMzMgLTIuMjAxNjY2NjY2NjY2NjY2NywgOS4zIC0xLjg0NjY2NjY2NjY2NjY2NjcsIDkuMyAtMS4zOCBMIDkuMyAxLjcwMDAwMDAwMDAwMDAwMDIgQyA5LjMgMS45NzMzMzMzMzMzMzMzMzM2LCA5LjQ1IDIuMTEwMDAwMDAwMDAwMDAwMywgOS43NSAyLjExMDAwMDAwMDAwMDAwMDMgQyA5LjgwOTk5OTk5OTk5OTk5OSAyLjExMDAwMDAwMDAwMDAwMDMsIDkuODcgMi4xMDMzMzMzMzMzMzMzMzM1LCA5LjkzIDIuMDkgWiBNIDguNDcgMC45MzAwMDAwMDAwMDAwMDAyIEwgOC40NyAtMC4wMDk5OTk5OTk5OTk5OTk3ODcgQyA4LjI1IDAuMDkwMDAwMDAwMDAwMDAwMTYsIDcuODAzMzMzMzMzMzMzMzMzIDAuMTg2NjY2NjY2NjY2NjY2ODQsIDcuMTMgMC4yODAwMDAwMDAwMDAwMDAyNSBDIDYuNjgzMzMzMzMzMzMzMzM0IDAuMzQ2NjY2NjY2NjY2NjY2NywgNi4zNjE2NjY2NjY2NjY2NjYgMC40NTQ5OTk5OTk5OTk5OTk5LCA2LjE2NSAwLjYwNSBDIDUuOTY4MzMzMzMzMzMzMzM0IDAuNzU1LCA1Ljg3IDAuOTY2NjY2NjY2NjY2NjY2NywgNS44NyAxLjI0IEMgNS44NyAxLjUwNjY2NjY2NjY2NjY2NjgsIDUuOTYwMDAwMDAwMDAwMDAxIDEuNzEzMzMzMzMzMzMzMzMzNCwgNi4xNDAwMDAwMDAwMDAwMDEgMS44NiBDIDYuMzIgMi4wMDY2NjY2NjY2NjY2NjcsIDYuNTczMzMzMzMzMzMzMzM0IDIuMDgsIDYuOSAyLjA4IEMgNy4zODAwMDAwMDAwMDAwMDEgMi4wOCwgNy43OTMzMzMzMzMzMzMzMzMgMS45MjMzMzMzMzMzMzMzMzMzLCA4LjE0IDEuNjEgQyA4LjM2MDAwMDAwMDAwMDAwMSAxLjQxMDAwMDAwMDAwMDAwMDEsIDguNDcgMS4xODMzMzMzMzMzMzMzMzM2LCA4LjQ3IDAuOTMwMDAwMDAwMDAwMDAwMiBaICIgc3Ryb2tlPSJub25lIiBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjEiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsNTQsMTcpIiBpZD0iNjNiYTlhMDctMDVjMy00NmNiLWE1YTEtMWM5NDFjYjVhODVjIiAvPg0KICA8cGF0aCBkPSJNIDUgLTMuNzYgTCA1LjgzIC0zLjc2IEwgNS44MyAtMSBDIDYuMjEgLTEuNTczMzMzMzMzMzMzMzMyOCwgNi43NSAtMS44NTk5OTk5OTk5OTk5OTk0LCA3LjQ1IC0xLjg1OTk5OTk5OTk5OTk5OTQgQyA4LjE0MzMzMzMzMzMzMzMzNCAtMS44NTk5OTk5OTk5OTk5OTk0LCA4LjY5IC0xLjYxNDk5OTk5OTk5OTk5OTMsIDkuMDkgLTEuMTI0OTk5OTk5OTk5OTk5MSBDIDkuNDkgLTAuNjM0OTk5OTk5OTk5OTk5NiwgOS42OTAwMDAwMDAwMDAwMDEgMC4wMzY2NjY2NjY2NjY2NjY5LCA5LjY5MDAwMDAwMDAwMDAwMSAwLjg5MDAwMDAwMDAwMDAwMDEgQyA5LjY5MDAwMDAwMDAwMDAwMSAxLjc1NjY2NjY2NjY2NjY2NjgsIDkuNDgzMzMzMzMzMzMzMzM0IDIuNDUxNjY2NjY2NjY2NjY3LCA5LjA3IDIuOTc1IEMgOC42NTY2NjY2NjY2NjY2NjYgMy40OTgzMzMzMzMzMzMzMzM1LCA4LjEwMzMzMzMzMzMzMzMzMyAzLjc2MDAwMDAwMDAwMDAwMDIsIDcuNDEgMy43NjAwMDAwMDAwMDAwMDAyIEMgNi42OTY2NjY2NjY2NjY2NjcgMy43NjAwMDAwMDAwMDAwMDAyLCA2LjE0MzMzMzMzMzMzMzMzMzUgMy40NjAwMDAwMDAwMDAwMDA0LCA1Ljc1IDIuODYwMDAwMDAwMDAwMDAwMyBMIDUuNzUgMy41MzAwMDAwMDAwMDAwMDAyIEwgNSAzLjUzMDAwMDAwMDAwMDAwMDIgWiBNIDcuMjkgLTEuMDggQyA2Ljg0MzMzMzMzMzMzMzMzNCAtMS4wOCwgNi40ODgzMzMzMzMzMzMzMzMgLTAuODk0OTk5OTk5OTk5OTk5OSwgNi4yMjUgLTAuNTI0OTk5OTk5OTk5OTk5NSBDIDUuOTYxNjY2NjY2NjY2NjY2IC0wLjE1NDk5OTk5OTk5OTk5OTY3LCA1LjgzIDAuMzM2NjY2NjY2NjY2NjY2OSwgNS44MyAwLjk1MDAwMDAwMDAwMDAwMDIgQyA1LjgzIDEuNTYzMzMzMzMzMzMzMzMzNSwgNS45NjE2NjY2NjY2NjY2NjYgMi4wNTUsIDYuMjI1IDIuNDI1MDAwMDAwMDAwMDAwMyBDIDYuNDg4MzMzMzMzMzMzMzMzIDIuNzk1MDAwMDAwMDAwMDAwNCwgNi44NDMzMzMzMzMzMzMzMzQgMi45ODAwMDAwMDAwMDAwMDA0LCA3LjI5IDIuOTgwMDAwMDAwMDAwMDAwNCBDIDcuNzQzMzMzMzMzMzMzMzM0IDIuOTgwMDAwMDAwMDAwMDAwNCwgOC4xMTE2NjY2NjY2NjY2NjYgMi43OTUwMDAwMDAwMDAwMDA0LCA4LjM5NSAyLjQyNTAwMDAwMDAwMDAwMDMgQyA4LjY3ODMzMzMzMzMzMzMzMyAyLjA1NSwgOC44MiAxLjU3MzMzMzMzMzMzMzMzMzcsIDguODIgMC45ODAwMDAwMDAwMDAwMDA0IEMgOC44MiAwLjM1MzMzMzMzMzMzMzMzMzUsIDguNjgxNjY2NjY2NjY2NjY3IC0wLjE0NjY2NjY2NjY2NjY2Njc4LCA4LjQwNTAwMDAwMDAwMDAwMSAtMC41MjAwMDAwMDAwMDAwMDA1IEMgOC4xMjgzMzMzMzMzMzMzMzQgLTAuODkzMzMzMzMzMzMzMzMzNSwgNy43NTY2NjY2NjY2NjY2NjggLTEuMDgsIDcuMjkgLTEuMDggWiAiIHN0cm9rZT0ibm9uZSIgZmlsbD0iIzAwMDAwMCIgZmlsbC1vcGFjaXR5PSIxIiB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwxLDcxLjUsMzEpIiBpZD0iNzJlMGZiM2UtZDZkZS00MTA0LTgzMWMtOGExZTE4ODRjMDM3IiAvPg0KICA8cGF0aCBkPSJNIDkuNCAtMC44OTk5OTk5OTk5OTk5OTk5IEwgOC41NiAtMC44OTk5OTk5OTk5OTk5OTk5IEMgOC41MDY2NjY2NjY2NjY2NjggLTEuMjY2NjY2NjY2NjY2NjY2OCwgOC4zNzMzMzMzMzMzMzMzMzMgLTEuNTQ4MzMzMzMzMzMzMzMzMywgOC4xNiAtMS43NDUgQyA3Ljk0NjY2NjY2NjY2NjY2NyAtMS45NDE2NjY2NjY2NjY2NjY5LCA3LjY2NjY2NjY2NjY2NjY2NiAtMi4wNCwgNy4zMiAtMi4wNCBDIDYuODY2NjY2NjY2NjY2NjY3IC0yLjA0LCA2LjUxMTY2NjY2NjY2NjY2NyAtMS44NTUsIDYuMjU1MDAwMDAwMDAwMDAxIC0xLjQ4NDk5OTk5OTk5OTk5OTQgQyA1Ljk5ODMzMzMzMzMzMzMzNCAtMS4xMTQ5OTk5OTk5OTk5OTk1LCA1Ljg3IC0wLjYwMzMzMzMzMzMzMzMzMywgNS44NyAwLjA1MDAwMDAwMDAwMDAwMDI2NiBDIDUuODcgMC42NywgNiAxLjE1NjY2NjY2NjY2NjY2NjcsIDYuMjYgMS41MSBDIDYuNTIgMS44NjMzMzMzMzMzMzMzMzMzLCA2Ljg4MDAwMDAwMDAwMDAwMSAyLjA0LCA3LjM0IDIuMDQgQyA4LjA1MzMzMzMzMzMzMzMzMyAyLjA0LCA4LjQ4IDEuNjIsIDguNjIwMDAwMDAwMDAwMDAxIDAuNzggTCA5LjQ2IDAuNzggQyA5LjQwNjY2NjY2NjY2NjY2OCAxLjQyMDAwMDAwMDAwMDAwMDIsIDkuMTkzMzMzMzMzMzMzMzMzIDEuOTE4MzMzMzMzMzMzMzMzNCwgOC44MiAyLjI3NSBDIDguNDQ2NjY2NjY2NjY2NjY3IDIuNjMxNjY2NjY2NjY2NjY3LCA3Ljk0NjY2NjY2NjY2NjY2NyAyLjgxLCA3LjMyIDIuODEgQyA2LjYwNjY2NjY2NjY2NjY2NyAyLjgxLCA2LjA0MTY2NjY2NjY2NjY2NyAyLjU2MTY2NjY2NjY2NjY2NjUsIDUuNjI1IDIuMDY1IEMgNS4yMDgzMzMzMzMzMzMzMzQgMS41NjgzMzMzMzMzMzMzMzM0LCA1IDAuODk2NjY2NjY2NjY2NjY2NywgNSAwLjA1MDAwMDAwMDAwMDAwMDI2NiBDIDUgLTAuODIzMzMzMzMzMzMzMzMzMSwgNS4yMTE2NjY2NjY2NjY2NjcgLTEuNTE4MzMzMzMzMzMzMzMzLCA1LjYzNTAwMDAwMDAwMDAwMSAtMi4wMzUgQyA2LjA1ODMzMzMzMzMzMzMzNDUgLTIuNTUxNjY2NjY2NjY2NjY2MywgNi42MjMzMzMzMzMzMzMzMzQgLTIuODA5OTk5OTk5OTk5OTk5NiwgNy4zMyAtMi44MDk5OTk5OTk5OTk5OTk2IEMgOC4wOTY2NjY2NjY2NjY2NjggLTIuODA5OTk5OTk5OTk5OTk5NiwgOC42NyAtMi41NSwgOS4wNSAtMi4wMzAwMDAwMDAwMDAwMDAyIEMgOS4yNDMzMzMzMzMzMzMzMzQgLTEuNzQzMzMzMzMzMzMzMzMzMiwgOS4zNiAtMS4zNjY2NjY2NjY2NjY2NjY1LCA5LjQgLTAuODk5OTk5OTk5OTk5OTk5OSBaICIgc3Ryb2tlPSJub25lIiBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjEiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsODksNDUpIiBpZD0iMGU3OTkxMmItZDQ2MC00NGY5LWFmNWYtZGZlMDQ3MTY3Mjg5IiAvPg0KICA8cGF0aCBkPSJNIDkuNjkwMDAwMDAwMDAwMDAxIC0zLjc2IEwgOS42OTAwMDAwMDAwMDAwMDEgMy41MzAwMDAwMDAwMDAwMDAyIEwgOC45NSAzLjUzMDAwMDAwMDAwMDAwMDIgTCA4Ljk1IDIuODQwMDAwMDAwMDAwMDAwMyBDIDguNzIzMzMzMzMzMzMzMzMzIDMuMTY2NjY2NjY2NjY2NjY3LCA4LjQ3ODMzMzMzMzMzMzMzMiAzLjQwMTY2NjY2NjY2NjY2NzMsIDguMjE1IDMuNTQ1MDAwMDAwMDAwMDAwNCBDIDcuOTUxNjY2NjY2NjY2NjY3IDMuNjg4MzMzMzMzMzMzMzMzNSwgNy42NDAwMDAwMDAwMDAwMDEgMy43NjAwMDAwMDAwMDAwMDAyLCA3LjI4IDMuNzYwMDAwMDAwMDAwMDAwMiBDIDYuNTczMzMzMzMzMzMzMzM0IDMuNzYwMDAwMDAwMDAwMDAwMiwgNi4wMTY2NjY2NjY2NjY2Njc1IDMuNTA1MDAwMDAwMDAwMDAwMywgNS42MSAyLjk5NSBDIDUuMjAzMzMzMzMzMzMzMzMzIDIuNDg1MDAwMDAwMDAwMDAwMywgNSAxLjc4NjY2NjY2NjY2NjY2NywgNSAwLjkwMDAwMDAwMDAwMDAwMDQgQyA1IDAuMDY2NjY2NjY2NjY2NjY3MDEsIDUuMjA1IC0wLjYwMTY2NjY2NjY2NjY2NjIsIDUuNjE1IC0xLjEwNDk5OTk5OTk5OTk5OTUgQyA2LjAyNSAtMS42MDgzMzMzMzMzMzMzMzI3LCA2LjU3IC0xLjg1OTk5OTk5OTk5OTk5OTQsIDcuMjUgLTEuODU5OTk5OTk5OTk5OTk5NCBDIDcuOTcwMDAwMDAwMDAwMDAxIC0xLjg1OTk5OTk5OTk5OTk5OTQsIDguNTA2NjY2NjY2NjY2NjY4IC0xLjU4OTk5OTk5OTk5OTk5OTQsIDguODYgLTEuMDQ5OTk5OTk5OTk5OTk5OCBMIDguODYgLTMuNzYgWiBNIDguNDY1IC0wLjUyNDk5OTk5OTk5OTk5OTUgQyA4LjIwMTY2NjY2NjY2NjY2NiAtMC44OTQ5OTk5OTk5OTk5OTk5LCA3Ljg0MzMzMzMzMzMzMzMzNCAtMS4wOCwgNy4zOTAwMDAwMDAwMDAwMDEgLTEuMDggQyA2LjkzNjY2NjY2NjY2NjY2NyAtMS4wOCwgNi41NyAtMC44OTMzMzMzMzMzMzMzMzM1LCA2LjI5IC0wLjUyMDAwMDAwMDAwMDAwMDUgQyA2LjAxIC0wLjE0NjY2NjY2NjY2NjY2Njc4LCA1Ljg3IDAuMzQzMzMzMzMzMzMzMzMzNCwgNS44NyAwLjk1MDAwMDAwMDAwMDAwMDIgQyA1Ljg3IDEuNTYzMzMzMzMzMzMzMzMzNSwgNi4wMSAyLjA1NSwgNi4yOSAyLjQyNTAwMDAwMDAwMDAwMDMgQyA2LjU3IDIuNzk1MDAwMDAwMDAwMDAwNCwgNi45NCAyLjk4MDAwMDAwMDAwMDAwMDQsIDcuNCAyLjk4MDAwMDAwMDAwMDAwMDQgQyA3Ljg0MDAwMDAwMDAwMDAwMSAyLjk4MDAwMDAwMDAwMDAwMDQsIDguMTkzMzMzMzMzMzMzMzM1IDIuNzk2NjY2NjY2NjY2NjY3LCA4LjQ2IDIuNDMgQyA4LjcyNjY2NjY2NjY2NjY2NyAyLjA2MzMzMzMzMzMzMzMzMzUsIDguODYgMS41NzY2NjY2NjY2NjY2NjcsIDguODYgMC45NzAwMDAwMDAwMDAwMDAyIEMgOC44NiAwLjM0MzMzMzMzMzMzMzMzMzYsIDguNzI4MzMzMzMzMzMzMzMzIC0wLjE1NDk5OTk5OTk5OTk5OTY3LCA4LjQ2NSAtMC41MjQ5OTk5OTk5OTk5OTk1IFogIiBzdHJva2U9Im5vbmUiIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMSIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSw4OSw1OSkiIGlkPSI5MzU0ZjZkZS1mNTc0LTQ5ZGMtODk2Ni1kNTAzOTE4NWViOTAiIC8+DQogIDxwYXRoIGQ9Ik0gOS43MyAwLjI0MDAwMDAwMDAwMDAwMDIgTCA1Ljg2OTk5OTk5OTk5OTk5OSAwLjI0MDAwMDAwMDAwMDAwMDIgQyA1Ljg3NjY2NjY2NjY2NjY2NiAwLjcyMDAwMDAwMDAwMDAwMDEsIDUuOTcgMS4wOTMzMzMzMzMzMzMzMzMzLCA2LjE0OTk5OTk5OTk5OTk5OTUgMS4zNiBDIDYuNDM2NjY2NjY2NjY2NjY2NSAxLjgxMzMzMzMzMzMzMzMzMzUsIDYuODU2NjY2NjY2NjY2NjY3IDIuMDQsIDcuNDEgMi4wNCBDIDguMDkgMi4wNCwgOC41NDY2NjY2NjY2NjY2NjcgMS42OTAwMDAwMDAwMDAwMDAyLCA4Ljc4IDAuOTkgTCA5LjYyIDAuOTkgQyA5LjUxMzMzMzMzMzMzMzMzNCAxLjU2MzMzMzMzMzMzMzMzMzUsIDkuMjYzMzMzMzMzMzMzMzM1IDIuMDEwMDAwMDAwMDAwMDAwMiwgOC44NzAwMDAwMDAwMDAwMDEgMi4zMyBDIDguNDc2NjY2NjY2NjY2NjY3IDIuNjUsIDcuOTc5OTk5OTk5OTk5OTk5IDIuODEsIDcuMzc5OTk5OTk5OTk5OTk5IDIuODEgQyA2LjYzOTk5OTk5OTk5OTk5OSAyLjgxLCA2LjA1ODMzMzMzMzMzMzMzMyAyLjU2MzMzMzMzMzMzMzMzMzUsIDUuNjM1IDIuMDcwMDAwMDAwMDAwMDAwMyBDIDUuMjExNjY2NjY2NjY2NjY3IDEuNTc2NjY2NjY2NjY2NjY2NywgNSAwLjg5NjY2NjY2NjY2NjY2NjgsIDUgMC4wMzAwMDAwMDAwMDAwMDAyNSBDIDUgLTAuODM2NjY2NjY2NjY2NjY2NiwgNS4yMTY2NjY2NjY2NjY2NjcgLTEuNTI2NjY2NjY2NjY2NjY2OCwgNS42NDk5OTk5OTk5OTk5OTk1IC0yLjA0IEMgNi4wODMzMzMzMzMzMzMzMzMgLTIuNTUzMzMzMzMzMzMzMzMzMiwgNi42NjY2NjY2NjY2NjY2NjYgLTIuODA5OTk5OTk5OTk5OTk5NiwgNy4zOTk5OTk5OTk5OTk5OTk1IC0yLjgwOTk5OTk5OTk5OTk5OTYgQyA3Ljg5MzMzMzMzMzMzMzMzMyAtMi44MDk5OTk5OTk5OTk5OTk2LCA4LjMyODMzMzMzMzMzMzMzMyAtMi42ODY2NjY2NjY2NjY2NjYsIDguNzA1IC0yLjQzOTk5OTk5OTk5OTk5OTUgQyA5LjA4MTY2NjY2NjY2NjY2NyAtMi4xOTMzMzMzMzMzMzMzMzM0LCA5LjM1MzMzMzMzMzMzMzMzMyAtMS44NTY2NjY2NjY2NjY2NjY3LCA5LjUyIC0xLjQyOTk5OTk5OTk5OTk5OTcgQyA5LjY2IC0xLjA2MzMzMzMzMzMzMzMzMywgOS43MyAtMC41MDY2NjY2NjY2NjY2NjY1LCA5LjczIDAuMjQwMDAwMDAwMDAwMDAwMiBaIE0gNS44OSAtMC40Mzk5OTk5OTk5OTk5OTk5NSBMIDguODMgLTAuNDM5OTk5OTk5OTk5OTk5OTUgQyA4LjgzIC0wLjkxMzMzMzMzMzMzMzMzMzIsIDguNjk2NjY2NjY2NjY2NjY3IC0xLjI5ODMzMzMzMzMzMzMzMzMsIDguNDMgLTEuNTk0OTk5OTk5OTk5OTk5OCBDIDguMTYzMzMzMzMzMzMzMzMyIC0xLjg5MTY2NjY2NjY2NjY2NjYsIDcuODE2NjY2NjY2NjY2NjY2IC0yLjA0LCA3LjM5IC0yLjA0IEMgNi45NzAwMDAwMDAwMDAwMDEgLTIuMDQsIDYuNjIzMzMzMzMzMzMzMzMzIC0xLjg5NTAwMDAwMDAwMDAwMDIsIDYuMzUgLTEuNjA1MDAwMDAwMDAwMDAwNCBDIDYuMDc2NjY2NjY2NjY2NjY2IC0xLjMxNSwgNS45MjMzMzMzMzMzMzMzMzMgLTAuOTI2NjY2NjY2NjY2NjY2NSwgNS44OSAtMC40Mzk5OTk5OTk5OTk5OTk5NSBaICIgc3Ryb2tlPSJub25lIiBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjEiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMzYuNSw3MykiIGlkPSI1NzVlNjUxYS02NTQwLTQzMTQtYjY1Ny1jZTY3MzNiYjJjM2QiIC8+DQo8L3N2Zz4=">
    /// </p>
    ///
    /// If the LCA of `b`, `c` and `d` (highlighted in the tree) is selected as the subject of this module, then its two
    /// direct children (`b` and `(c,d)`) are pruned off of it and grafted on its parent, so that they become siblings of
    /// `a`:
    ///
    /// <p align="center">
    /// <img height="300" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHZpZXdCb3g9IjAgMCAxMDguNjkgODUuODEiIHZlcnNpb249IjEuMSIgc3R5bGU9ImZvbnQtc3ludGhlc2lzOiBub25lOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCiAgPHBhdGggZD0iTSAwIDAgTCAxMDguNjkgMCBMIDEwOC42OSA4NS44MSBMIDAgODUuODEgWiAiIHN0cm9rZT0ibm9uZSIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1vcGFjaXR5PSIxIiB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwxLDAsMCkiIC8+DQogIDxwYXRoIGQ9Ik0gLTcuMDAwMDAwMDAwMDAwMDAyIDQzLjc1IEwgMCA0My43NSAiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjEiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBmaWxsPSJub25lIiB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwxLDE5LDEwKSIgaWQ9IjI4NDZiMGE3LWZiYjMtNGY1ZC1iZmY3LTk0ODA0YjVhNWZjNiIgLz4NCiAgPHBhdGggZD0iTSAwIDQzLjc1IEwgMCAyNC41IEwgMjMuMzMzMzMzMzMzMzMzMzMyIDI0LjUgIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIxIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZmlsbD0ibm9uZSIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxOSwxMCkiIGlkPSJhNmJhNTYwNS0xNjZkLTQwYTQtODNjMy1jZGE1OWYwNWI3NzUiIC8+DQogIDxwYXRoIGQ9Ik0gMjMuMzMzMzMzMzMzMzMzMzMyIDI0LjUgTCAyMy4zMzMzMzMzMzMzMzMzMzIgNyBMIDQ2LjY2NjY2NjY2NjY2NjY2NCA3ICIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTksMTApIiBpZD0iNmQwMjRlYTAtOTQxMy00YmJkLTk2ZGItYjVhZWQxYmQzN2E1IiAvPg0KICA8cGF0aCBkPSJNIDIzLjMzMzMzMzMzMzMzMzMzMiAyNC41IEwgMjMuMzMzMzMzMzMzMzMzMzMyIDIxIEwgNDYuNjY2NjY2NjY2NjY2NjY0IDIxICIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTksMTApIiBpZD0iMmJkMWE5ZjYtMTUxNC00ZTMwLWJjYzktMjNiNDUxYzI1OGNmIiAvPg0KICA8cGF0aCBkPSJNIDIzLjMzMzMzMzMzMzMzMzMzMiAyNC41IEwgMjMuMzMzMzMzMzMzMzMzMzMyIDQyIEwgNDYuNjY2NjY2NjY2NjY2NjY0IDQyICIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTksMTApIiBpZD0iNzEyYTM1MjEtMTExMS00MzNmLWI5YjItODQ1MWJlZTgyNGQwIiAvPg0KICA8cGF0aCBkPSJNIDQ2LjY2NjY2NjY2NjY2NjY2NCA0MiBMIDQ2LjY2NjY2NjY2NjY2NjY2NCAzNSBMIDcwIDM1ICIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTksMTApIiBpZD0iZDk4NDcwYzktZTlmNy00MGI1LThhMWQtNzMwZGNiYzE4MjYyIiAvPg0KICA8cGF0aCBkPSJNIDQ2LjY2NjY2NjY2NjY2NjY2NCA0MiBMIDQ2LjY2NjY2NjY2NjY2NjY2NCA0OSBMIDcwIDQ5ICIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTksMTApIiBpZD0iOWQ0N2Q2ODItNTA3Mi00NDFiLTk5NWEtMjM3YzA1OTMzZGIxIiAvPg0KICA8cGF0aCBkPSJNIDAgNDMuNzUgTCAwIDYzIEwgMjMuMzMzMzMzMzMzMzMzMzMyIDYzICIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTksMTApIiBpZD0iYjEzMDBhOTUtYjM5OS00NTZjLTkxNGEtMDAwNjA5Mzg0Zjc1IiAvPg0KICA8cGF0aCBkPSJNIDkuOTMgMi4wOSBMIDkuOTMgMi43MiBDIDkuNjkgMi43ODAwMDAwMDAwMDAwMDAyLCA5LjUgMi44MSwgOS4zNiAyLjgxIEMgOS4wODY2NjY2NjY2NjY2NjYgMi44MSwgOC44ODE2NjY2NjY2NjY2NjYgMi43NDgzMzMzMzMzMzMzMzMsIDguNzQ1MDAwMDAwMDAwMDAxIDIuNjI1IEMgOC42MDgzMzMzMzMzMzMzMzMgMi41MDE2NjY2NjY2NjY2NjcsIDguNTI2NjY2NjY2NjY2NjY2IDIuMzA2NjY2NjY2NjY2NjY2NiwgOC41IDIuMDQgQyA3LjkzOTk5OTk5OTk5OTk5OTUgMi41NTMzMzMzMzMzMzMzMzMyLCA3LjM0NjY2NjY2NjY2NjY2NyAyLjgxLCA2LjcyMDAwMDAwMDAwMDAwMSAyLjgxIEMgNi4xOTMzMzMzMzMzMzMzMzMgMi44MSwgNS43NzQ5OTk5OTk5OTk5OTk1IDIuNjcsIDUuNDY1IDIuMzkgQyA1LjE1NSAyLjExMDAwMDAwMDAwMDAwMDMsIDUgMS43MzMzMzMzMzMzMzMzMzM0LCA1IDEuMjYgQyA1IDAuNTg2NjY2NjY2NjY2NjY2NywgNS4zMDY2NjY2NjY2NjY2NjcgMC4xMTk5OTk5OTk5OTk5OTk5NCwgNS45MiAtMC4xNDAwMDAwMDAwMDAwMDAxMiBDIDYuMDg2NjY2NjY2NjY2NjY3IC0wLjIwNjY2NjY2NjY2NjY2NjU1LCA2LjI2MzMzMzMzMzMzMzMzNCAtMC4yNTgzMzMzMzMzMzMzMzMxNCwgNi40NSAtMC4yOTQ5OTk5OTk5OTk5OTk5MyBDIDYuNjM2NjY2NjY2NjY2NjY3IC0wLjMzMTY2NjY2NjY2NjY2NjcsIDcuMDIwMDAwMDAwMDAwMDAwNSAtMC4zODY2NjY2NjY2NjY2NjY3LCA3LjYgLTAuNDU5OTk5OTk5OTk5OTk5OTYgQyA3LjkzOTk5OTk5OTk5OTk5OTUgLTAuNTA2NjY2NjY2NjY2NjY2NiwgOC4xNjgzMzMzMzMzMzMzMzMgLTAuNTY5OTk5OTk5OTk5OTk5OCwgOC4yODUgLTAuNjQ5OTk5OTk5OTk5OTk5OSBDIDguNDAxNjY2NjY2NjY2NjY3IC0wLjczLCA4LjQ2MzMzMzMzMzMzMzMzNSAtMC44NiwgOC40NyAtMS4wNCBMIDguNDcgLTEuMjU5OTk5OTk5OTk5OTk5OCBDIDguNDcgLTEuNzgsIDguMDgwMDAwMDAwMDAwMDAyIC0yLjA0LCA3LjMwMDAwMDAwMDAwMDAwMSAtMi4wNCBDIDYuOTEzMzMzMzMzMzMzMzM0IC0yLjA0LCA2LjYyMDAwMDAwMDAwMDAwMSAtMS45NjQ5OTk5OTk5OTk5OTk5LCA2LjQyIC0xLjgxNDk5OTk5OTk5OTk5OTUgQyA2LjIyMDAwMDAwMDAwMDAwMSAtMS42NjQ5OTk5OTk5OTk5OTk2LCA2LjEwMzMzMzMzMzMzMzMzMzUgLTEuNDI5OTk5OTk5OTk5OTk5NywgNi4wNyAtMS4xMDk5OTk5OTk5OTk5OTk5IEwgNS4yMyAtMS4xMDk5OTk5OTk5OTk5OTk5IEMgNS4yNSAtMS41ODk5OTk5OTk5OTk5OTk5LCA1LjM2OTk5OTk5OTk5OTk5OSAtMS45NTMzMzMzMzMzMzMzMzM0LCA1LjU5IC0yLjIgQyA1Ljk2MzMzMzMzMzMzMzMzNCAtMi42MDY2NjY2NjY2NjY2NjY1LCA2LjU0MzMzMzMzMzMzMzMzNCAtMi44MDk5OTk5OTk5OTk5OTk2LCA3LjMzIC0yLjgwOTk5OTk5OTk5OTk5OTYgQyA3Ljk3NjY2NjY2NjY2NjY2NzUgLTIuODA5OTk5OTk5OTk5OTk5NiwgOC40NjY2NjY2NjY2NjY2NjkgLTIuNjg4MzMzMzMzMzMzMzMzLCA4LjggLTIuNDQ1MDAwMDAwMDAwMDAwMyBDIDkuMTMzMzMzMzMzMzMzMzMzIC0yLjIwMTY2NjY2NjY2NjY2NjcsIDkuMyAtMS44NDY2NjY2NjY2NjY2NjY3LCA5LjMgLTEuMzggTCA5LjMgMS43MDAwMDAwMDAwMDAwMDAyIEMgOS4zIDEuOTczMzMzMzMzMzMzMzMzNiwgOS40NSAyLjExMDAwMDAwMDAwMDAwMDMsIDkuNzUgMi4xMTAwMDAwMDAwMDAwMDAzIEMgOS44MDk5OTk5OTk5OTk5OTkgMi4xMTAwMDAwMDAwMDAwMDAzLCA5Ljg3IDIuMTAzMzMzMzMzMzMzMzMzNSwgOS45MyAyLjA5IFogTSA4LjQ3IDAuOTMwMDAwMDAwMDAwMDAwMiBMIDguNDcgLTAuMDA5OTk5OTk5OTk5OTk5Nzg3IEMgOC4yNSAwLjA5MDAwMDAwMDAwMDAwMDE2LCA3LjgwMzMzMzMzMzMzMzMzMyAwLjE4NjY2NjY2NjY2NjY2Njg0LCA3LjEzIDAuMjgwMDAwMDAwMDAwMDAwMjUgQyA2LjY4MzMzMzMzMzMzMzMzNCAwLjM0NjY2NjY2NjY2NjY2NjcsIDYuMzYxNjY2NjY2NjY2NjY2IDAuNDU0OTk5OTk5OTk5OTk5OSwgNi4xNjUgMC42MDUgQyA1Ljk2ODMzMzMzMzMzMzMzNCAwLjc1NSwgNS44NyAwLjk2NjY2NjY2NjY2NjY2NjcsIDUuODcgMS4yNCBDIDUuODcgMS41MDY2NjY2NjY2NjY2NjY4LCA1Ljk2MDAwMDAwMDAwMDAwMSAxLjcxMzMzMzMzMzMzMzMzMzQsIDYuMTQwMDAwMDAwMDAwMDAxIDEuODYgQyA2LjMyIDIuMDA2NjY2NjY2NjY2NjY3LCA2LjU3MzMzMzMzMzMzMzMzNCAyLjA4LCA2LjkgMi4wOCBDIDcuMzgwMDAwMDAwMDAwMDAxIDIuMDgsIDcuNzkzMzMzMzMzMzMzMzMzIDEuOTIzMzMzMzMzMzMzMzMzMywgOC4xNCAxLjYxIEMgOC4zNjAwMDAwMDAwMDAwMDEgMS40MTAwMDAwMDAwMDAwMDAxLCA4LjQ3IDEuMTgzMzMzMzMzMzMzMzMzNiwgOC40NyAwLjkzMDAwMDAwMDAwMDAwMDIgWiAiIHN0cm9rZT0ibm9uZSIgZmlsbD0iIzAwMDAwMCIgZmlsbC1vcGFjaXR5PSIxIiB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwxLDY1LjY2NjY2NjY2NjY2NjY2LDE3KSIgaWQ9IjZkMDI0ZWEwLTk0MTMtNGJiZC05NmRiLWI1YWVkMWJkMzdhNSIgLz4NCiAgPHBhdGggZD0iTSA1IC0zLjc2IEwgNS44MyAtMy43NiBMIDUuODMgLTEgQyA2LjIxIC0xLjU3MzMzMzMzMzMzMzMzMjgsIDYuNzUgLTEuODU5OTk5OTk5OTk5OTk5NCwgNy40NSAtMS44NTk5OTk5OTk5OTk5OTk0IEMgOC4xNDMzMzMzMzMzMzMzMzQgLTEuODU5OTk5OTk5OTk5OTk5NCwgOC42OSAtMS42MTQ5OTk5OTk5OTk5OTkzLCA5LjA5IC0xLjEyNDk5OTk5OTk5OTk5OTEgQyA5LjQ5IC0wLjYzNDk5OTk5OTk5OTk5OTYsIDkuNjkwMDAwMDAwMDAwMDAxIDAuMDM2NjY2NjY2NjY2NjY2OSwgOS42OTAwMDAwMDAwMDAwMDEgMC44OTAwMDAwMDAwMDAwMDAxIEMgOS42OTAwMDAwMDAwMDAwMDEgMS43NTY2NjY2NjY2NjY2NjY4LCA5LjQ4MzMzMzMzMzMzMzMzNCAyLjQ1MTY2NjY2NjY2NjY2NywgOS4wNyAyLjk3NSBDIDguNjU2NjY2NjY2NjY2NjY2IDMuNDk4MzMzMzMzMzMzMzMzNSwgOC4xMDMzMzMzMzMzMzMzMzMgMy43NjAwMDAwMDAwMDAwMDAyLCA3LjQxIDMuNzYwMDAwMDAwMDAwMDAwMiBDIDYuNjk2NjY2NjY2NjY2NjY3IDMuNzYwMDAwMDAwMDAwMDAwMiwgNi4xNDMzMzMzMzMzMzMzMzM1IDMuNDYwMDAwMDAwMDAwMDAwNCwgNS43NSAyLjg2MDAwMDAwMDAwMDAwMDMgTCA1Ljc1IDMuNTMwMDAwMDAwMDAwMDAwMiBMIDUgMy41MzAwMDAwMDAwMDAwMDAyIFogTSA3LjI5IC0xLjA4IEMgNi44NDMzMzMzMzMzMzMzMzQgLTEuMDgsIDYuNDg4MzMzMzMzMzMzMzMzIC0wLjg5NDk5OTk5OTk5OTk5OTksIDYuMjI1IC0wLjUyNDk5OTk5OTk5OTk5OTUgQyA1Ljk2MTY2NjY2NjY2NjY2NiAtMC4xNTQ5OTk5OTk5OTk5OTk2NywgNS44MyAwLjMzNjY2NjY2NjY2NjY2NjksIDUuODMgMC45NTAwMDAwMDAwMDAwMDAyIEMgNS44MyAxLjU2MzMzMzMzMzMzMzMzMzUsIDUuOTYxNjY2NjY2NjY2NjY2IDIuMDU1LCA2LjIyNSAyLjQyNTAwMDAwMDAwMDAwMDMgQyA2LjQ4ODMzMzMzMzMzMzMzMyAyLjc5NTAwMDAwMDAwMDAwMDQsIDYuODQzMzMzMzMzMzMzMzM0IDIuOTgwMDAwMDAwMDAwMDAwNCwgNy4yOSAyLjk4MDAwMDAwMDAwMDAwMDQgQyA3Ljc0MzMzMzMzMzMzMzMzNCAyLjk4MDAwMDAwMDAwMDAwMDQsIDguMTExNjY2NjY2NjY2NjY2IDIuNzk1MDAwMDAwMDAwMDAwNCwgOC4zOTUgMi40MjUwMDAwMDAwMDAwMDAzIEMgOC42NzgzMzMzMzMzMzMzMzMgMi4wNTUsIDguODIgMS41NzMzMzMzMzMzMzMzMzM3LCA4LjgyIDAuOTgwMDAwMDAwMDAwMDAwNCBDIDguODIgMC4zNTMzMzMzMzMzMzMzMzM1LCA4LjY4MTY2NjY2NjY2NjY2NyAtMC4xNDY2NjY2NjY2NjY2NjY3OCwgOC40MDUwMDAwMDAwMDAwMDEgLTAuNTIwMDAwMDAwMDAwMDAwNSBDIDguMTI4MzMzMzMzMzMzMzM0IC0wLjg5MzMzMzMzMzMzMzMzMzUsIDcuNzU2NjY2NjY2NjY2NjY4IC0xLjA4LCA3LjI5IC0xLjA4IFogIiBzdHJva2U9Im5vbmUiIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMSIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSw2NS42NjY2NjY2NjY2NjY2NiwzMSkiIGlkPSIyYmQxYTlmNi0xNTE0LTRlMzAtYmNjOS0yM2I0NTFjMjU4Y2YiIC8+DQogIDxwYXRoIGQ9Ik0gOS40IC0wLjg5OTk5OTk5OTk5OTk5OTkgTCA4LjU2IC0wLjg5OTk5OTk5OTk5OTk5OTkgQyA4LjUwNjY2NjY2NjY2NjY2OCAtMS4yNjY2NjY2NjY2NjY2NjY4LCA4LjM3MzMzMzMzMzMzMzMzMyAtMS41NDgzMzMzMzMzMzMzMzMzLCA4LjE2IC0xLjc0NSBDIDcuOTQ2NjY2NjY2NjY2NjY3IC0xLjk0MTY2NjY2NjY2NjY2NjksIDcuNjY2NjY2NjY2NjY2NjY2IC0yLjA0LCA3LjMyIC0yLjA0IEMgNi44NjY2NjY2NjY2NjY2NjcgLTIuMDQsIDYuNTExNjY2NjY2NjY2NjY3IC0xLjg1NSwgNi4yNTUwMDAwMDAwMDAwMDEgLTEuNDg0OTk5OTk5OTk5OTk5NCBDIDUuOTk4MzMzMzMzMzMzMzM0IC0xLjExNDk5OTk5OTk5OTk5OTUsIDUuODcgLTAuNjAzMzMzMzMzMzMzMzMzLCA1Ljg3IDAuMDUwMDAwMDAwMDAwMDAwMjY2IEMgNS44NyAwLjY3LCA2IDEuMTU2NjY2NjY2NjY2NjY2NywgNi4yNiAxLjUxIEMgNi41MiAxLjg2MzMzMzMzMzMzMzMzMzMsIDYuODgwMDAwMDAwMDAwMDAxIDIuMDQsIDcuMzQgMi4wNCBDIDguMDUzMzMzMzMzMzMzMzMzIDIuMDQsIDguNDggMS42MiwgOC42MjAwMDAwMDAwMDAwMDEgMC43OCBMIDkuNDYgMC43OCBDIDkuNDA2NjY2NjY2NjY2NjY4IDEuNDIwMDAwMDAwMDAwMDAwMiwgOS4xOTMzMzMzMzMzMzMzMzMgMS45MTgzMzMzMzMzMzMzMzM0LCA4LjgyIDIuMjc1IEMgOC40NDY2NjY2NjY2NjY2NjcgMi42MzE2NjY2NjY2NjY2NjcsIDcuOTQ2NjY2NjY2NjY2NjY3IDIuODEsIDcuMzIgMi44MSBDIDYuNjA2NjY2NjY2NjY2NjY3IDIuODEsIDYuMDQxNjY2NjY2NjY2NjY3IDIuNTYxNjY2NjY2NjY2NjY2NSwgNS42MjUgMi4wNjUgQyA1LjIwODMzMzMzMzMzMzMzNCAxLjU2ODMzMzMzMzMzMzMzMzQsIDUgMC44OTY2NjY2NjY2NjY2NjY3LCA1IDAuMDUwMDAwMDAwMDAwMDAwMjY2IEMgNSAtMC44MjMzMzMzMzMzMzMzMzMxLCA1LjIxMTY2NjY2NjY2NjY2NyAtMS41MTgzMzMzMzMzMzMzMzMsIDUuNjM1MDAwMDAwMDAwMDAxIC0yLjAzNSBDIDYuMDU4MzMzMzMzMzMzMzM0NSAtMi41NTE2NjY2NjY2NjY2NjYzLCA2LjYyMzMzMzMzMzMzMzMzNCAtMi44MDk5OTk5OTk5OTk5OTk2LCA3LjMzIC0yLjgwOTk5OTk5OTk5OTk5OTYgQyA4LjA5NjY2NjY2NjY2NjY2OCAtMi44MDk5OTk5OTk5OTk5OTk2LCA4LjY3IC0yLjU1LCA5LjA1IC0yLjAzMDAwMDAwMDAwMDAwMDIgQyA5LjI0MzMzMzMzMzMzMzMzNCAtMS43NDMzMzMzMzMzMzMzMzMyLCA5LjM2IC0xLjM2NjY2NjY2NjY2NjY2NjUsIDkuNCAtMC44OTk5OTk5OTk5OTk5OTk5IFogIiBzdHJva2U9Im5vbmUiIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMSIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSw4OSw0NSkiIGlkPSJkOTg0NzBjOS1lOWY3LTQwYjUtOGExZC03MzBkY2JjMTgyNjIiIC8+DQogIDxwYXRoIGQ9Ik0gOS42OTAwMDAwMDAwMDAwMDEgLTMuNzYgTCA5LjY5MDAwMDAwMDAwMDAwMSAzLjUzMDAwMDAwMDAwMDAwMDIgTCA4Ljk1IDMuNTMwMDAwMDAwMDAwMDAwMiBMIDguOTUgMi44NDAwMDAwMDAwMDAwMDAzIEMgOC43MjMzMzMzMzMzMzMzMzMgMy4xNjY2NjY2NjY2NjY2NjcsIDguNDc4MzMzMzMzMzMzMzMyIDMuNDAxNjY2NjY2NjY2NjY3MywgOC4yMTUgMy41NDUwMDAwMDAwMDAwMDA0IEMgNy45NTE2NjY2NjY2NjY2NjcgMy42ODgzMzMzMzMzMzMzMzM1LCA3LjY0MDAwMDAwMDAwMDAwMSAzLjc2MDAwMDAwMDAwMDAwMDIsIDcuMjggMy43NjAwMDAwMDAwMDAwMDAyIEMgNi41NzMzMzMzMzMzMzMzMzQgMy43NjAwMDAwMDAwMDAwMDAyLCA2LjAxNjY2NjY2NjY2NjY2NzUgMy41MDUwMDAwMDAwMDAwMDAzLCA1LjYxIDIuOTk1IEMgNS4yMDMzMzMzMzMzMzMzMzMgMi40ODUwMDAwMDAwMDAwMDAzLCA1IDEuNzg2NjY2NjY2NjY2NjY3LCA1IDAuOTAwMDAwMDAwMDAwMDAwNCBDIDUgMC4wNjY2NjY2NjY2NjY2NjcwMSwgNS4yMDUgLTAuNjAxNjY2NjY2NjY2NjY2MiwgNS42MTUgLTEuMTA0OTk5OTk5OTk5OTk5NSBDIDYuMDI1IC0xLjYwODMzMzMzMzMzMzMzMjcsIDYuNTcgLTEuODU5OTk5OTk5OTk5OTk5NCwgNy4yNSAtMS44NTk5OTk5OTk5OTk5OTk0IEMgNy45NzAwMDAwMDAwMDAwMDEgLTEuODU5OTk5OTk5OTk5OTk5NCwgOC41MDY2NjY2NjY2NjY2NjggLTEuNTg5OTk5OTk5OTk5OTk5NCwgOC44NiAtMS4wNDk5OTk5OTk5OTk5OTk4IEwgOC44NiAtMy43NiBaIE0gOC40NjUgLTAuNTI0OTk5OTk5OTk5OTk5NSBDIDguMjAxNjY2NjY2NjY2NjY2IC0wLjg5NDk5OTk5OTk5OTk5OTksIDcuODQzMzMzMzMzMzMzMzM0IC0xLjA4LCA3LjM5MDAwMDAwMDAwMDAwMSAtMS4wOCBDIDYuOTM2NjY2NjY2NjY2NjY3IC0xLjA4LCA2LjU3IC0wLjg5MzMzMzMzMzMzMzMzMzUsIDYuMjkgLTAuNTIwMDAwMDAwMDAwMDAwNSBDIDYuMDEgLTAuMTQ2NjY2NjY2NjY2NjY2NzgsIDUuODcgMC4zNDMzMzMzMzMzMzMzMzM0LCA1Ljg3IDAuOTUwMDAwMDAwMDAwMDAwMiBDIDUuODcgMS41NjMzMzMzMzMzMzMzMzM1LCA2LjAxIDIuMDU1LCA2LjI5IDIuNDI1MDAwMDAwMDAwMDAwMyBDIDYuNTcgMi43OTUwMDAwMDAwMDAwMDA0LCA2Ljk0IDIuOTgwMDAwMDAwMDAwMDAwNCwgNy40IDIuOTgwMDAwMDAwMDAwMDAwNCBDIDcuODQwMDAwMDAwMDAwMDAxIDIuOTgwMDAwMDAwMDAwMDAwNCwgOC4xOTMzMzMzMzMzMzMzMzUgMi43OTY2NjY2NjY2NjY2NjcsIDguNDYgMi40MyBDIDguNzI2NjY2NjY2NjY2NjY3IDIuMDYzMzMzMzMzMzMzMzMzNSwgOC44NiAxLjU3NjY2NjY2NjY2NjY2NywgOC44NiAwLjk3MDAwMDAwMDAwMDAwMDIgQyA4Ljg2IDAuMzQzMzMzMzMzMzMzMzMzNiwgOC43MjgzMzMzMzMzMzMzMzMgLTAuMTU0OTk5OTk5OTk5OTk5NjcsIDguNDY1IC0wLjUyNDk5OTk5OTk5OTk5OTUgWiAiIHN0cm9rZT0ibm9uZSIgZmlsbD0iIzAwMDAwMCIgZmlsbC1vcGFjaXR5PSIxIiB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwxLDg5LDU5KSIgaWQ9IjlkNDdkNjgyLTUwNzItNDQxYi05OTVhLTIzN2MwNTkzM2RiMSIgLz4NCiAgPHBhdGggZD0iTSA5LjczIDAuMjQwMDAwMDAwMDAwMDAwMiBMIDUuODY5OTk5OTk5OTk5OTk5IDAuMjQwMDAwMDAwMDAwMDAwMiBDIDUuODc2NjY2NjY2NjY2NjY2IDAuNzIwMDAwMDAwMDAwMDAwMSwgNS45NyAxLjA5MzMzMzMzMzMzMzMzMzMsIDYuMTQ5OTk5OTk5OTk5OTk5NSAxLjM2IEMgNi40MzY2NjY2NjY2NjY2NjY1IDEuODEzMzMzMzMzMzMzMzMzNSwgNi44NTY2NjY2NjY2NjY2NjcgMi4wNCwgNy40MSAyLjA0IEMgOC4wOSAyLjA0LCA4LjU0NjY2NjY2NjY2NjY2NyAxLjY5MDAwMDAwMDAwMDAwMDIsIDguNzggMC45OSBMIDkuNjIgMC45OSBDIDkuNTEzMzMzMzMzMzMzMzM0IDEuNTYzMzMzMzMzMzMzMzMzNSwgOS4yNjMzMzMzMzMzMzMzMzUgMi4wMTAwMDAwMDAwMDAwMDAyLCA4Ljg3MDAwMDAwMDAwMDAwMSAyLjMzIEMgOC40NzY2NjY2NjY2NjY2NjcgMi42NSwgNy45Nzk5OTk5OTk5OTk5OTkgMi44MSwgNy4zNzk5OTk5OTk5OTk5OTkgMi44MSBDIDYuNjM5OTk5OTk5OTk5OTk5IDIuODEsIDYuMDU4MzMzMzMzMzMzMzMzIDIuNTYzMzMzMzMzMzMzMzMzNSwgNS42MzUgMi4wNzAwMDAwMDAwMDAwMDAzIEMgNS4yMTE2NjY2NjY2NjY2NjcgMS41NzY2NjY2NjY2NjY2NjY3LCA1IDAuODk2NjY2NjY2NjY2NjY2OCwgNSAwLjAzMDAwMDAwMDAwMDAwMDI1IEMgNSAtMC44MzY2NjY2NjY2NjY2NjY2LCA1LjIxNjY2NjY2NjY2NjY2NyAtMS41MjY2NjY2NjY2NjY2NjY4LCA1LjY0OTk5OTk5OTk5OTk5OTUgLTIuMDQgQyA2LjA4MzMzMzMzMzMzMzMzMyAtMi41NTMzMzMzMzMzMzMzMzMyLCA2LjY2NjY2NjY2NjY2NjY2NiAtMi44MDk5OTk5OTk5OTk5OTk2LCA3LjM5OTk5OTk5OTk5OTk5OTUgLTIuODA5OTk5OTk5OTk5OTk5NiBDIDcuODkzMzMzMzMzMzMzMzMzIC0yLjgwOTk5OTk5OTk5OTk5OTYsIDguMzI4MzMzMzMzMzMzMzMzIC0yLjY4NjY2NjY2NjY2NjY2NiwgOC43MDUgLTIuNDM5OTk5OTk5OTk5OTk5NSBDIDkuMDgxNjY2NjY2NjY2NjY3IC0yLjE5MzMzMzMzMzMzMzMzMzQsIDkuMzUzMzMzMzMzMzMzMzMzIC0xLjg1NjY2NjY2NjY2NjY2NjcsIDkuNTIgLTEuNDI5OTk5OTk5OTk5OTk5NyBDIDkuNjYgLTEuMDYzMzMzMzMzMzMzMzMzLCA5LjczIC0wLjUwNjY2NjY2NjY2NjY2NjUsIDkuNzMgMC4yNDAwMDAwMDAwMDAwMDAyIFogTSA1Ljg5IC0wLjQzOTk5OTk5OTk5OTk5OTk1IEwgOC44MyAtMC40Mzk5OTk5OTk5OTk5OTk5NSBDIDguODMgLTAuOTEzMzMzMzMzMzMzMzMzMiwgOC42OTY2NjY2NjY2NjY2NjcgLTEuMjk4MzMzMzMzMzMzMzMzMywgOC40MyAtMS41OTQ5OTk5OTk5OTk5OTk4IEMgOC4xNjMzMzMzMzMzMzMzMzIgLTEuODkxNjY2NjY2NjY2NjY2NiwgNy44MTY2NjY2NjY2NjY2NjYgLTIuMDQsIDcuMzkgLTIuMDQgQyA2Ljk3MDAwMDAwMDAwMDAwMSAtMi4wNCwgNi42MjMzMzMzMzMzMzMzMzMgLTEuODk1MDAwMDAwMDAwMDAwMiwgNi4zNSAtMS42MDUwMDAwMDAwMDAwMDA0IEMgNi4wNzY2NjY2NjY2NjY2NjYgLTEuMzE1LCA1LjkyMzMzMzMzMzMzMzMzMyAtMC45MjY2NjY2NjY2NjY2NjY1LCA1Ljg5IC0wLjQzOTk5OTk5OTk5OTk5OTk1IFogIiBzdHJva2U9Im5vbmUiIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMSIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSw0Mi4zMzMzMzMzMzMzMzMzMyw3MykiIGlkPSJiMTMwMGE5NS1iMzk5LTQ1NmMtOTE0YS0wMDA2MDkzODRmNzUiIC8+DQo8L3N2Zz4=">
    /// </p>
    ///
    /// You can imagine this as if the branch leading to the node that is being polytomised were to be compressed until
    /// it has length 0.
    /// ]]>
    /// </description>

    public static class MyModule
    {
        public const string Name = "Polytomise node";
        public const string HelpText = "Transforms nodes into politomies.";
        public const string Author = "Giorgio Bianchini";
        public static Version Version = new Version("1.0.1");
        public const ModuleTypes ModuleType = ModuleTypes.FurtherTransformation;

        public const string Id = "19d9a555-07e6-4dac-afc1-d5ffcef35f76";

        public static bool Repeatable { get; } = true;
        
        private static string Icon16Base64 = "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABqSURBVDhPY6AUMEJpOCgqKvoPZZIHSDWACUqTDSg2ACMMkAEx3kExwKt2YwOQqgfixm3N/iA2QcAEsgWEgQDEB2lGpgkCpr6+PkYQBgIQvxEsiqAJAowwALkEahh5aWIYpAOy/D2AgIEBAK9sIxBWstekAAAAAElFTkSuQmCC";
        private static string Icon24Base64 = "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADESURBVEhLzZRNDgIhDIWLJxu3mngYWPu75zBO4lpvhpRpDAMMKGUiXzIpkAmPtg+EMQbWRFBchHuARQEp5cWG8zSrZ0MxBXtzJJeBq43W+vOPEMWKRuQyaEJfAuioX79iD7gkBVDZRylVbVl3k0N37I73wYbnNIPt43Z44aDGRSIsBdpyfxpna1bA7dylTZNHaloiihF+o1lNphixqk2Rv7xF4f34hr7eoqYuatXkKAOsM9X66haYFHOuaaxPVoC7OQDAG55GbedfodH5AAAAAElFTkSuQmCC";
        private static string Icon32Base64 = "iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAERSURBVFhH7ZZLDoIwEIapJ3Otid4F1j7QNYfRRLceDTuFmkltO1Po2JD4JZNSQunfeYGqPPR9P17J4xWAkRZDCqjr+qyH0zDLz2ocY4htDnA8YGLQdZ3SmHtcOOHjeGAWIDpmogJgAwpxD1D8BSQJgKzObewylIIUACotTdOs9fAaZnmICtgcbrgNt8/rHuZerFBO6eFnFT4hZnu8+74BHxGhdT5go9DzyhdjaLtagHfF47Kjj5hA8TL8Oo11VSgE2gPBPJjCpCQEkTbZrOBYnGOQ8cQv/XkZAsUbEf4hMTcyk1QFpnE4loq7fnYZui+kzGVZn2MJli8A+kTMKIr3AY4H2nEUgfQAx41zKJyEVfUGjAG3F+nFSsIAAAAASUVORK5CYII=";

        public static Page GetIcon(double scaling)
        {
            byte[] bytes;

            if (scaling <= 1)
            {

                bytes = Convert.FromBase64String(Icon16Base64);
            }
            else if (scaling <= 1.5)
            {
                bytes = Convert.FromBase64String(Icon24Base64);
            }
            else
            {
                bytes = Convert.FromBase64String(Icon32Base64);
            }

            IntPtr imagePtr = Marshal.AllocHGlobal(bytes.Length);
            Marshal.Copy(bytes, 0, imagePtr, bytes.Length);

            RasterImage icon;

            try
            {
                icon = new VectSharp.MuPDFUtils.RasterImageStream(imagePtr, bytes.Length, MuPDFCore.InputFileTypes.PNG);
            }
            catch (Exception ex)
            {
                throw ex.InnerException;
            }
            finally
            {
                Marshal.FreeHGlobal(imagePtr);
            }

            Page pag = new Page(16, 16);
            pag.Graphics.DrawRasterImage(0, 0, 16, 16, icon);

            return pag;
        }

        public static List<(string, string)> GetParameters(TreeNode tree)
        {
            List<string> leafNames = tree.GetLeafNames();

            return new List<(string, string)>()
            {
                /// <param name="Mode:">
                /// This parameter determines whether a single node is transformed into a polytomy, or whether all nodes matching
                /// a search criterion are transformed into polytomies.
                /// </param>
                ( "Mode:", "ComboBox:0[\"Single node\",\"Attribute match\"]" ),

                ("Attribute match", "Group:6"),
                
                /// <param name="Attribute:">
                /// This parameter determines the attribute that needs to match the search criterion. If the attribute name
                /// entered here does not exist in the tree, the module does nothing.
                /// </param>
                ("Attribute:", "TextBox:"),
                
                /// <param name="Attribute type:">
                /// This parameter should correspond to the correct attribute type for the attribute that needs to match the
                /// search criterion. If the attribute type is incorrect, the module does nothing.
                /// </param>
                ("Attribute type:", "AttributeType:String"),
                
                /// <param name="Value:">
                /// This text box is used to enter the value that needs to be matched.
                /// </param>
                ("Value:", "TextBox:"),
                
                /// <param name="Comparison type: " display="Comparison type (`Number`)">
                /// If the [Attribute type](#attribute-type) of the attribute that is being matched is `Number`,
                /// the module can match attributes that are equal, smaller than or greather than the specified [Value](#value).
                /// </param>
                ("Comparison type: ", "ComboBox:0[\"Equal\", \"Smaller than\", \"Greater than\"]"),
                
                /// <param name="Comparison type:" display="Comparison type (`String`)">
                /// If the [Attribute type](#attribute-type) of the attribute that is being matched is `String`,
                /// this parameter determines how the strings are compared. If the value is `Normal`, the strings need to match
                /// exactly. If the value is `Case insensitive`, the case of the strings does not matter (e.g. `AaBbCc` matches
                /// both `aabbcc` and `AABBCC`). If the value is `Culture-aware`, the comparison takes into account culture-specific
                /// rules of the current display language of the OS (for example, in Hungarian `ddzs` would match `dzsdzs`).
                /// </param>
                ("Comparison type:", "ComboBox:0[\"Normal\", \"Case-insensitive\", \"Culture-aware\", \"Culture-aware, case-insensitive\"]"),
                
                /// <param name="Regex">
                /// If this check box is checked, string matches are performed using a regular expression. This makes it possible to
                /// search for complicated strings.
                /// </param>
                ("Regex", "CheckBox:false"),

                /// <param name="Node:">
                /// This parameter determines the node that will be politomised.
                /// </param>
                ("Node:", "Node:[" + System.Text.Json.JsonSerializer.Serialize(leafNames[0]) +"," + System.Text.Json.JsonSerializer.Serialize(leafNames[^1]) + "]"),

                /// <param name="Apply recursively to all children">
                /// This parameter determines whether all children of the selected node(s) are transformed into polytomies.
                /// </param>
                ("Apply recursively to all children", "CheckBox:false"),
                
                /// <param name="Apply">
                /// Applies the changes to the other parameter values and triggers an update of the tree.
                /// </param>
                ("Apply", "Button:")
            };
        }

        public static bool OnParameterChange(object tree, Dictionary<string, object> previousParameterValues, Dictionary<string, object> currentParameterValues, out Dictionary<string, ControlStatus> controlStatus, out Dictionary<string, object> parametersToChange)
        {
            controlStatus = new Dictionary<string, ControlStatus>();
            parametersToChange = new Dictionary<string, object>() { { "Apply", false } };

            if ((string)currentParameterValues["Attribute type:"] == "String")
            {
                controlStatus.Add("Comparison type:", ControlStatus.Enabled);
                controlStatus.Add("Comparison type: ", ControlStatus.Hidden);
                controlStatus.Add("Regex", ControlStatus.Enabled);
            }
            else if ((string)currentParameterValues["Attribute type:"] == "Number")
            {
                controlStatus.Add("Comparison type:", ControlStatus.Hidden);
                controlStatus.Add("Comparison type: ", ControlStatus.Enabled);
                controlStatus.Add("Regex", ControlStatus.Hidden);
            }

            if ((string)previousParameterValues["Attribute:"] != (string)currentParameterValues["Attribute:"])
            {
                string attributeName = (string)currentParameterValues["Attribute:"];

                string attrType = ((TreeNode)tree).GetAttributeType(attributeName);

                if ((string)previousParameterValues["Attribute type:"] == (string)currentParameterValues["Attribute type:"])
                {
                    if (!string.IsNullOrEmpty(attrType))
                    {
                        parametersToChange.Add("Attribute type:", attrType);

                        if (attrType == "String")
                        {
                            controlStatus["Comparison type:"] = ControlStatus.Enabled;
                            controlStatus["Comparison type: "] = ControlStatus.Hidden;
                            controlStatus["Regex"] = ControlStatus.Enabled;
                        }
                        else if (attrType == "Number")
                        {
                            controlStatus["Comparison type:"] = ControlStatus.Hidden;
                            controlStatus["Comparison type: "] = ControlStatus.Enabled;
                            controlStatus["Regex"] = ControlStatus.Hidden;
                        }
                    }
                }
            }

            if ((int)currentParameterValues["Mode:"] == 0)
            {
                controlStatus["Attribute match"] = ControlStatus.Hidden;
                controlStatus["Attribute:"] = ControlStatus.Hidden;
                controlStatus["Attribute type:"] = ControlStatus.Hidden;
                controlStatus["Value:"] = ControlStatus.Hidden;
                controlStatus["Comparison type: "] = ControlStatus.Hidden;
                controlStatus["Comparison type:"] = ControlStatus.Hidden;
                controlStatus["Regex"] = ControlStatus.Hidden;
                controlStatus["Node:"] = ControlStatus.Enabled;
            }
            else if ((int)currentParameterValues["Mode:"] == 1)
            {
                controlStatus["Attribute match"] = ControlStatus.Enabled;
                controlStatus["Attribute:"] = ControlStatus.Enabled;
                controlStatus["Attribute type:"] = ControlStatus.Enabled;
                controlStatus["Value:"] = ControlStatus.Enabled;
                controlStatus["Node:"] = ControlStatus.Hidden;
            }

            return (bool)currentParameterValues["Apply"] || (previousParameterValues["Node:"] != currentParameterValues["Node:"]) || ((bool)previousParameterValues["Apply recursively to all children"] != (bool)currentParameterValues["Apply recursively to all children"]);
        }

        private static void PolytomiseNode(TreeNode node, bool allChildren)
        {
            if (node.Parent != null && node.Children.Count > 1)
            {
                foreach (TreeNode child in node.Children)
                {
                    child.Length += node.Length;
                    child.Parent = node.Parent;
                    node.Parent.Children.Add(child);

                    if (allChildren)
                    {
                        PolytomiseNode(child, allChildren);
                    }
                }

                node.Children.Clear();
                node.Parent.Children.Remove(node);
            }
            else if (node.Children.Count > 1 && allChildren)
            {
                List<TreeNode> nodes = new List<TreeNode>(node.Children);

                foreach (TreeNode child in nodes)
                {
                    PolytomiseNode(child, allChildren);
                }
            }
        }

        public static void Transform(ref TreeNode tree, Dictionary<string, object> parameterValues, Action<double> progressAction)
        {
            int mode = (int)parameterValues["Mode:"];

            bool allChildren = (bool)parameterValues["Apply recursively to all children"];

            if (mode == 0)
            {
                string[] nodeElements = (string[])parameterValues["Node:"];
                TreeNode node = tree.GetLastCommonAncestor(nodeElements);

                if (node == null)
                {
                    throw new Exception("Could not find the requested node! If you have changed the Name of some nodes, please select the node again!");
                }

                PolytomiseNode(node, allChildren);
            }
            else if (mode == 1)
            {
                List<TreeNode> nodes = tree.GetChildrenRecursive();

                string attributeName = (string)parameterValues["Attribute:"];

                string attrType = (string)parameterValues["Attribute type:"];

                string attrValue = (string)parameterValues["Value:"];

                double numberNeedle = attrType == "Number" ? double.Parse(attrValue) : -1;

                int comparisonType = attrType == "String" ? (int)parameterValues["Comparison type:"] : (int)parameterValues["Comparison type: "];

                bool regex = (bool)parameterValues["Regex"];

                StringComparison comparison = StringComparison.InvariantCulture;
                RegexOptions options = RegexOptions.CultureInvariant;
                switch (comparisonType)
                {
                    case 0:
                        comparison = StringComparison.InvariantCulture;
                        options = RegexOptions.CultureInvariant;
                        break;
                    case 1:
                        comparison = StringComparison.InvariantCultureIgnoreCase;
                        options = RegexOptions.IgnoreCase | RegexOptions.CultureInvariant;
                        break;
                    case 2:
                        comparison = StringComparison.CurrentCulture;
                        options = RegexOptions.None;
                        break;
                    case 3:
                        comparison = StringComparison.CurrentCultureIgnoreCase;
                        options = RegexOptions.IgnoreCase;
                        break;
                }


                Regex reg = regex ? new Regex(attrValue, options) : null;

                foreach (TreeNode node in nodes)
                {
                    bool matched = false;

                    if (node.Attributes.TryGetValue(attributeName, out object attributeValue))
                    {
                        if (attrType == "String" && attributeValue is string actualValue)
                        {
                            if (regex)
                            {
                                if (reg.IsMatch(actualValue))
                                {
                                    matched = true;
                                }
                            }
                            else
                            {
                                if (actualValue.Contains(attrValue, comparison))
                                {
                                    matched = true;
                                }
                            }
                        }
                        else if (attrType == "Number" && attributeValue is double actualNumber)
                        {
                            switch (comparisonType)
                            {
                                case 0:
                                    if (actualNumber == numberNeedle)
                                    {
                                        matched = true;
                                    }
                                    break;
                                case 1:
                                    if (actualNumber < numberNeedle)
                                    {
                                        matched = true;
                                    }
                                    break;
                                case 2:
                                    if (actualNumber > numberNeedle)
                                    {
                                        matched = true;
                                    }
                                    break;
                            }
                        }
                    }

                    if (matched)
                    {
                        PolytomiseNode(node, allChildren);
                    }
                }
            }
        }
    }
}
